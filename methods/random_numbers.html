<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>4. Random Number Generation &mdash; OpenMC Documentation</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenMC Documentation" href="../index.html" />
    <link rel="up" title="Theory and Methodology" href="index.html" />
    <link rel="next" title="5. Physics" href="physics.html" />
    <link rel="prev" title="3. Cross Section Representation" href="cross_sections.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner">
        <a href="../index.html">
          <img class="logo" src="../_static/openmc.png" alt="Logo"/>
        </a>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="cross_sections.html">3. Cross Section Representation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="physics.html">5. Physics</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="random-number-generation">
<span id="methods-random-numbers"></span><h1>4. Random Number Generation<a class="headerlink" href="#random-number-generation" title="Permalink to this headline">¶</a></h1>
<p>In order to sample probability distributions, one must be able to produce random
numbers. The standard technique to do this is to generate numbers on the
interval <img class="math" src="../_images/math/68adca6871086a90d32b8c23c1c5c3aa5c19d282.png" alt="[0,1)"/> from a deterministic sequence that has properties that
make it appear to be random, e.g. being uniformly distributed and not exhibiting
correlation between successive terms. Since the numbers produced this way are
not truly &#8220;random&#8221; in a strict sense, they are typically referred to as
pseudorandom numbers, and the techniques used to generate them are pseudorandom
number generators (PRNGs). Numbers sampled on the unit interval can then be
transformed for the purpose of sampling other continuous or discrete probability
distributions.</p>
<div class="section" id="linear-congruential-generators">
<h2>4.1. Linear Congruential Generators<a class="headerlink" href="#linear-congruential-generators" title="Permalink to this headline">¶</a></h2>
<p>There are a great number of algorithms for generating random numbers. One of the
simplest and commonly used algorithms is called a <a class="reference external" href="http://en.wikipedia.org/wiki/Linear_congruential_generator">linear congruential
generator</a>. We start with a random number <em>seed</em> <img class="math" src="../_images/math/68a45f4f778cb1713989fc95537efe07383c3357.png" alt="\xi_0"/> and a sequence
of random numbers can then be generated using the following recurrence relation:</p>
<div class="math" id="equation-lcg">
<p><span class="eqno">(1)</span><img src="../_images/math/182a1a0cf6ca2ebb24101947d51ae7abb35e6a52.png" alt="\xi_{i+1} = g \xi_i + c \mod M"/></p>
</div><p>where <img class="math" src="../_images/math/67f4714f065d485540ad40829e0717bf75e9dd85.png" alt="g"/>, <img class="math" src="../_images/math/65868d23a5bfe5b3b2d819386b19c14fa36af134.png" alt="c"/>, and <img class="math" src="../_images/math/2de38926392ba23abeac75effc66c37a5f5be5fd.png" alt="M"/> are constants. The choice of these
constants will have a profound effect on the quality and performance of the
generator, so they should not be chosen arbitrarily. As Donald Knuth stated in
his seminal work <em>The Art of Computer Programming</em>, &#8220;random numbers should not
be generated with a method chosen at random. Some theory should be used.&#8221;
Typically, <img class="math" src="../_images/math/2de38926392ba23abeac75effc66c37a5f5be5fd.png" alt="M"/> is chosen to be a power of two as this enables <img class="math" src="../_images/math/8931e872c6537749995fdd31ef70bab757ee143d.png" alt="x
\mod M"/> to be performed using the bitwise AND operator with a bit mask. The
constants for the linear congruential generator used by default in OpenMC are
<img class="math" src="../_images/math/ef1175baf719571a071178e52ffa90dc1ba033c9.png" alt="g = 2806196910506780709"/>, <img class="math" src="../_images/math/0599b15f9f80684c89195cda75b0d394d07c5055.png" alt="c = 1"/>, and <img class="math" src="../_images/math/b872fd5ec24dde8c3417e7f616c4bac56009be65.png" alt="M = 2^{63}"/> (see
<a class="reference internal" href="#lecuyer" id="id1">[LEcuyer]</a>).</p>
<div class="section" id="skip-ahead-capability">
<h3>4.1.1. Skip-ahead Capability<a class="headerlink" href="#skip-ahead-capability" title="Permalink to this headline">¶</a></h3>
<p>One of the important capabilities for a random number generator is to be able to
skip ahead in the sequence of random numbers. Without this capability, it would
be very difficult to maintain reproducibility in a parallel calculation. If we
want to skip ahead <img class="math" src="../_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> random numbers and <img class="math" src="../_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> is large, the cost of
sampling <img class="math" src="../_images/math/75e27f04188974063be3230dca208cd495b77ce1.png" alt="N"/> random numbers to get to that position may be prohibitively
expensive. Fortunately, algorithms have been developed that allow us to skip
ahead in <img class="math" src="../_images/math/c1573bb5fbdbc122c246b6558fdb3ad68d014f53.png" alt="O(\log_2 N)"/> operations instead of <img class="math" src="../_images/math/4d51d3f476c76dc066b26271168bc3b67f49d2be.png" alt="O(N)"/>. One algorithm
to do so is described in a paper by <a class="reference external" href="https://laws.lanl.gov/vhosts/mcnp.lanl.gov/pdf_files/anl_rn_arb-strides_1994.pdf">Brown</a>. This algorithm relies on the following
relationship:</p>
<div class="math" id="equation-lcg-skipahead">
<p><span class="eqno">(2)</span><img src="../_images/math/56731206eaf31bc12ca052ce9663212f4427e345.png" alt="\xi_{i+k} = g^k \xi_i + c \frac{g^k - 1}{g - 1} \mod M"/></p>
</div><p>Note that <a href="#equation-lcg-skipahead">(2)</a> has the same general form as eqref{eq:lcg}, so
the idea is to determine the new multiplicative and additive constants in
<img class="math" src="../_images/math/c1573bb5fbdbc122c246b6558fdb3ad68d014f53.png" alt="O(\log_2 N)"/> operations.</p>
<p class="rubric">References</p>
<table class="docutils citation" frame="void" id="lecuyer" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id1">[LEcuyer]</a></td><td>P. L’Ecuyer, &#8220;Tables of Linear Congruential Generators of
Different Sizes and Good Lattice Structures,&#8221; <em>Math. Comput.</em>, <strong>68</strong>, 249
(1999).</td></tr>
</tbody>
</table>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="cross_sections.html">3. Cross Section Representation</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="physics.html">5. Physics</a>&#160;&#160;»
        </p>

      </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2015, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>
</html>