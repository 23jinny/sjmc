<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>5. Troubleshooting &mdash; OpenMC Documentation</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenMC Documentation" href="../index.html" />
    <link rel="up" title="User’s Guide" href="index.html" />
    <link rel="next" title="Developer’s Guide" href="../devguide/index.html" />
    <link rel="prev" title="4. Data Processing and Visualization" href="processing.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner">
        <a href="../index.html">
          <img class="logo" src="../_static/openmc.png" alt="Logo"/>
        </a>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="processing.html">4. Data Processing and Visualization</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../devguide/index.html">Developer&#8217;s Guide</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="troubleshooting">
<span id="usersguide-troubleshoot"></span><h1>5. Troubleshooting<a class="headerlink" href="#troubleshooting" title="Permalink to this headline">¶</a></h1>
<div class="section" id="problems-with-compilation">
<h2>5.1. Problems with Compilation<a class="headerlink" href="#problems-with-compilation" title="Permalink to this headline">¶</a></h2>
<p>If you are experiencing problems trying to compile OpenMC, first check if the
error you are receiving is among the following options.</p>
<div class="section" id="undefined-reference-to-vtab">
<h3>5.1.1. undefined reference to `_vtab$...<a class="headerlink" href="#undefined-reference-to-vtab" title="Permalink to this headline">¶</a></h3>
<p>If you see this message when trying to compile, the most likely cause is that
you are using a compiler that does not support type-bound procedures from
Fortran 2003. This affects any version of gfortran prior to 4.6. Downloading and
installing the latest <a class="reference external" href="http://gcc.gnu.org/wiki/GFortran">gfortran</a> compiler should resolve this problem.</p>
</div>
<div class="section" id="gfortran-unrecognized-option-cpp">
<h3>5.1.2. gfortran: unrecognized option &#8216;-cpp&#8217;<a class="headerlink" href="#gfortran-unrecognized-option-cpp" title="Permalink to this headline">¶</a></h3>
<p>You are probably using a version of the gfortran compiler that is too
old. Download and install the latest version of <a class="reference external" href="http://gcc.gnu.org/wiki/GFortran">gfortran</a>.</p>
</div>
<div class="section" id="f951-error-unrecognized-command-line-option-fbacktrace">
<h3>5.1.3. f951: error: unrecognized command line option &#8220;-fbacktrace&#8221;<a class="headerlink" href="#f951-error-unrecognized-command-line-option-fbacktrace" title="Permalink to this headline">¶</a></h3>
<p>You are probably using a version of the gfortran compiler that is too
old. Download and install the latest version of <a class="reference external" href="http://gcc.gnu.org/wiki/GFortran">gfortran</a>.</p>
</div>
<div class="section" id="make-1-ifort-command-not-found">
<h3>5.1.4. make[1]: ifort: Command not found<a class="headerlink" href="#make-1-ifort-command-not-found" title="Permalink to this headline">¶</a></h3>
<p>You tried compiling with the Intel Fortran compiler and it was not found on your
<span class="target" id="index-0"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>. If you have the Intel compiler installed, make sure the shell
can locate it (this can be tested with <strong class="program">which ifort</strong>).</p>
</div>
<div class="section" id="make-1-pgf90-command-not-found">
<h3>5.1.5. make[1]: pgf90: Command not found<a class="headerlink" href="#make-1-pgf90-command-not-found" title="Permalink to this headline">¶</a></h3>
<p>You tried compiling with the PGI Fortran compiler and it was not found on your
<span class="target" id="index-1"></span><code class="xref std std-envvar docutils literal"><span class="pre">PATH</span></code>. If you have the PGI compiler installed, make sure the shell can
locate it (this can be tested with <strong class="program">which pgf90</strong>).</p>
</div>
</div>
<div class="section" id="problems-with-simulations">
<h2>5.2. Problems with Simulations<a class="headerlink" href="#problems-with-simulations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="segmentation-fault">
<h3>5.2.1. Segmentation Fault<a class="headerlink" href="#segmentation-fault" title="Permalink to this headline">¶</a></h3>
<p>A segmentation fault occurs when the program tries to access a variable in
memory that was outside the memory allocated for the program. The best way to
debug a segmentation fault is to re-compile OpenMC with debug options turned
on. First go to your <code class="docutils literal"><span class="pre">openmc/src</span></code> directory where OpenMC was compiled and type
the following commands:</p>
<div class="highlight-sh"><div class="highlight"><pre>make distclean
make <span class="nv">DEBUG</span><span class="o">=</span>yes
</pre></div>
</div>
<p>Now when you re-run your problem, it should report exactly where the program
failed. If after reading the debug output, you are still unsure why the program
failed, send an email to the OpenMC User&#8217;s Group <a class="reference external" href="https://groups.google.com/forum/?fromgroups=#!forum/openmc-users">mailing list</a>.</p>
</div>
<div class="section" id="error-no-cross-sections-xml-file-was-specified-in-settings-xml-or-in-the-cross-sections-environment-variable">
<h3>5.2.2. ERROR: No cross_sections.xml file was specified in settings.xml or in the CROSS_SECTIONS environment variable.<a class="headerlink" href="#error-no-cross-sections-xml-file-was-specified-in-settings-xml-or-in-the-cross-sections-environment-variable" title="Permalink to this headline">¶</a></h3>
<p>OpenMC needs to know where to find cross section data for each
nuclide. Information on what data is available and in what files is summarized
in a cross_sections.xml file. You need to tell OpenMC where to find the
cross_sections.xml file either with the <a class="reference internal" href="input.html#cross-sections"><span>&lt;cross_sections&gt; Element</span></a> in settings.xml or
with the <span class="target" id="index-2"></span><code class="xref std std-envvar docutils literal"><span class="pre">CROSS_SECTIONS</span></code> environment variable. It is recommended to add
a line in your <code class="docutils literal"><span class="pre">.profile</span></code> or <code class="docutils literal"><span class="pre">.bash_profile</span></code> setting the
<span class="target" id="index-3"></span><code class="xref std std-envvar docutils literal"><span class="pre">CROSS_SECTIONS</span></code> environment variable.</p>
</div>
<div class="section" id="geometry-debugging">
<h3>5.2.3. Geometry Debugging<a class="headerlink" href="#geometry-debugging" title="Permalink to this headline">¶</a></h3>
<div class="section" id="overlapping-cells">
<h4>5.2.3.1. Overlapping Cells<a class="headerlink" href="#overlapping-cells" title="Permalink to this headline">¶</a></h4>
<p>For fast run times, normal simulations do not check if the geometry is
incorrectly defined to have overlapping cells.  This can lead to incorrect
results that may or may not be obvious when there are errors in the geometry
input file.  The built-in 2D and 3D plotters will check for cell overlaps at
the center of every pixel or voxel position they process, however this might
not be a sufficient check to ensure correctly defined geometry.  For instance,
if an overlap is of small aspect ratio, the plotting resolution might not be
high enough to produce any pixels in the overlapping area.</p>
<p>To reliably validate a geometry input, it is best to run the problem in
geometry debugging mode with the <code class="docutils literal"><span class="pre">-g</span></code>, <code class="docutils literal"><span class="pre">-geometry-debug</span></code>, or
<code class="docutils literal"><span class="pre">--geometry-debug</span></code> command-line options.  This will enable checks for
overlapping cells at every move of esch simulated particle.  Depending on the
complexity of the geometry input file, this could add considerable overhead to
the run (these runs can still be done in parallel).  As a result, for this run
mode the user will probably want to run fewer particles than a normal
simulation run.  In this case it is important to be aware of how much coverage
each area of the geometry is getting.  For instance, if certain regions do not
have many particles travelling through them there will not be many locations
where overlaps are checked for in that region.  The user should refer to the
output after a geometry debug run to see how many checks were performed in each
cell, and then adjust the number of starting particles or starting source
distributions accordingly to achieve good coverage.</p>
</div>
<div class="section" id="error-after-particle-crossed-surface-it-could-not-be-located-in-any-cell-and-it-did-not-leak">
<h4>5.2.3.2. ERROR: After particle __ crossed surface __ it could not be located in any cell and it did not leak.<a class="headerlink" href="#error-after-particle-crossed-surface-it-could-not-be-located-in-any-cell-and-it-did-not-leak" title="Permalink to this headline">¶</a></h4>
<p>This error can arise either if a problem is specified with no boundary
conditions or if there is an error in the geometry itself. First check to ensure
that all of the outer surfaces of your geometry have been given vacuum or
reflective boundary conditions. If proper boundary conditions have been applied
and you still receive this error, it means that a surface/cell/lattice in your
geometry has been specified incorrectly or is missing.</p>
<p>The best way to debug this error is to turn on a trace for the particle getting
lost. After the error message, the code will display what batch, generation, and
particle number caused the error. In your settings.xml, add a <a class="reference internal" href="input.html#trace"><span>&lt;trace&gt; Element</span></a>
followed by the batch, generation, and particle number. This will give you
detailed output every time that particle enters a cell, crosses a boundary, or
has a collision. For example, if you received this error at cycle 5, generation
1, particle 4032, you would enter:</p>
<div class="highlight-xml"><div class="highlight"><pre><span class="nt">&lt;trace&gt;</span>5 1 4032<span class="nt">&lt;/trace&gt;</span>
</pre></div>
</div>
<p>For large runs it is often advantageous to run only the offending particle by
using particle restart mode with the <code class="docutils literal"><span class="pre">-s</span></code>, <code class="docutils literal"><span class="pre">-particle</span></code>, or <code class="docutils literal"><span class="pre">--particle</span></code>
command-line options in conjunction with the particle restart files that are
created when particles are lost with this error.</p>
</div>
</div>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="processing.html">4. Data Processing and Visualization</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="../devguide/index.html">Developer&#8217;s Guide</a>&#160;&#160;»
        </p>

      </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2015, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>
</html>