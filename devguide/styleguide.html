<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>2. Style Guide for OpenMC &mdash; OpenMC Documentation</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenMC Documentation" href="../index.html" />
    <link rel="up" title="Developer’s Guide" href="index.html" />
    <link rel="next" title="3. Development Workflow" href="workflow.html" />
    <link rel="prev" title="1. Data Structures" href="structures.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner">
        <a href="../index.html">
          <img class="logo" src="../_static/openmc.png" alt="Logo"/>
        </a>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="structures.html">1. Data Structures</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="workflow.html">3. Development Workflow</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="style-guide-for-openmc">
<span id="devguide-styleguide"></span><h1>2. Style Guide for OpenMC<a class="headerlink" href="#style-guide-for-openmc" title="Permalink to this headline">¶</a></h1>
<p>In order to keep the OpenMC code base consistent in style, this guide specifies
a number of rules which should be adhered to when modified existing code or
adding new code in OpenMC.</p>
<div class="section" id="fortran">
<h2>2.1. Fortran<a class="headerlink" href="#fortran" title="Permalink to this headline">¶</a></h2>
<div class="section" id="general-rules">
<h3>2.1.1. General Rules<a class="headerlink" href="#general-rules" title="Permalink to this headline">¶</a></h3>
<p>Conform to the Fortran 2008 standard.</p>
<p>Make sure code can be compiled with most common compilers, especially gfortran
and the Intel Fortran compiler. This supercedes the previous rule &#8212; if a
Fortran 2003/2008 feature is not implemented in a common compiler, do not use
it.</p>
<p>Do not use special extensions that can be only be used from certain compilers.</p>
<p>In general, write your code in lower-case. Having code in all caps does not
enhance code readability or otherwise.</p>
<p>Always include comments to describe what your code is doing. Do not be afraid of
using copious amounts of comments.</p>
<p>Use &lt;, &gt;, &lt;=, &gt;=, ==, and /= rather than .lt., .gt., .le., .ge., .eq., and .ne.</p>
<p>Try to keep code within 80 columns when possible.</p>
<p>Don&#8217;t use <code class="docutils literal"><span class="pre">print</span> <span class="pre">*</span></code> or <code class="docutils literal"><span class="pre">write(*,*)</span></code>. If writing to a file, use a specific
unit. Writing to standard output or standard error should be handled by the
<code class="docutils literal"><span class="pre">write_message</span></code> subroutine or functionality in the error module.</p>
</div>
<div class="section" id="procedures">
<h3>2.1.2. Procedures<a class="headerlink" href="#procedures" title="Permalink to this headline">¶</a></h3>
<p>Above each procedure, include a comment block giving a brief description of what
the procedure does.</p>
<p>Nonpointer dummy arguments to procedures should be explicitly specified as
intent(in), intent(out), or intent(inout).</p>
<p>Include a comment describing what each argument to a procedure is.</p>
</div>
<div class="section" id="variables">
<h3>2.1.3. Variables<a class="headerlink" href="#variables" title="Permalink to this headline">¶</a></h3>
<p>Never, under any circumstances, should implicit variables be used! Always
include <code class="docutils literal"><span class="pre">implicit</span> <span class="pre">none</span></code> and define all your variables.</p>
<p>Variable names should be all lower-case and descriptive, i.e. not a random
assortment of letters that doesn&#8217;t give any information to someone seeing it for
the first time. Variables consisting of multiple words should be separated by
underscores, not hyphens or in camel case.</p>
<p>Constant (parameter) variables should be in ALL CAPITAL LETTERS and defined in
in the constants.F90 module.</p>
<p>32-bit reals (real(4)) should never be used. Always use 64-bit reals (real(8)).</p>
<p>For arbitrary length character variables, use the pre-defined lengths
MAX_LINE_LEN, MAX_WORD_LEN, and MAX_FILE_LEN if possible.</p>
<p>Do not use old-style character/array length (e.g. character*80, real*8).</p>
<p>Integer values being used to indicate a certain state should be defined as named
constants (see the constants.F90 module for many examples).</p>
<p>Always use a double colon :: when declaring a variable.</p>
<p>Yes:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="n">boundary_condition</span> <span class="o">==</span> <span class="n">BC_VACUUM</span><span class="p">)</span> <span class="k">then</span>
</pre></div>
</div>
<p>No:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="k">if</span> <span class="p">(</span><span class="n">boundary_condition</span> <span class="o">==</span> <span class="o">-</span><span class="mi">10</span><span class="p">)</span> <span class="k">then</span>
</pre></div>
</div>
<p>Avoid creating arrays with a pre-defined maximum length. Use dynamic memory
allocation instead. Use allocatable variables instead of pointer variables when
possible.</p>
<div class="section" id="shared-module-variables">
<h4>2.1.3.1. Shared/Module Variables<a class="headerlink" href="#shared-module-variables" title="Permalink to this headline">¶</a></h4>
<p>Always put shared variables in modules. Access module variables through a
<code class="docutils literal"><span class="pre">use</span></code> statement. Always use the <code class="docutils literal"><span class="pre">only</span></code> specifier on the <code class="docutils literal"><span class="pre">use</span></code> statement
except for variables from the global, constants, and various header modules.</p>
<p>Never use <code class="docutils literal"><span class="pre">equivalence</span></code> statements, <code class="docutils literal"><span class="pre">common</span></code> blocks, or <code class="docutils literal"><span class="pre">data</span></code> statements.</p>
</div>
</div>
<div class="section" id="derived-types-and-classes">
<h3>2.1.4. Derived Types and Classes<a class="headerlink" href="#derived-types-and-classes" title="Permalink to this headline">¶</a></h3>
<p>Derived types and classes should have CamelCase names with words not separated
by underscores or hyphens.</p>
</div>
<div class="section" id="indentation">
<h3>2.1.5. Indentation<a class="headerlink" href="#indentation" title="Permalink to this headline">¶</a></h3>
<p>Never use tab characters. Indentation should always be applied using
spaces. Emacs users should include the following line in their .emacs file:</p>
<div class="highlight-common-lisp"><div class="highlight"><pre><span class="p">(</span><span class="nv">setq-default</span> <span class="nv">indent-tabs-mode</span> <span class="no">nil</span><span class="p">)</span>
</pre></div>
</div>
<p>vim users should include the following line in their .vimrc file:</p>
<div class="highlight-python"><div class="highlight"><pre>set expandtab
</pre></div>
</div>
<p>Use 2 spaces per indentation level. This applies to all constructs such as
program, subroutine, function, if, associate, etc. Emacs users should set the
variables f90-if-indent, f90-do-indent, f90-continuation-indent,
f90-type-indent, f90-associate-indent, and f90-program indent to 2.</p>
<p>Continuation lines should be indented by at least 5 spaces. They may be indented
more in order to make the content match the context.  For example, either of
these are valid continuation indentations:</p>
<div class="highlight-fortran"><div class="highlight"><pre><span class="n">local_xyz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">=</span> <span class="n">xyz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="p">(</span><span class="n">this</span> <span class="p">%</span> <span class="n">lower_left</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">+</span> <span class="p">&amp;</span>
     <span class="p">(</span><span class="n">i_xyz</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span> <span class="o">-</span> <span class="n">HALF</span><span class="p">)</span><span class="o">*</span><span class="n">this</span> <span class="p">%</span> <span class="n">pitch</span><span class="p">(</span><span class="mi">1</span><span class="p">))</span>
<span class="k">call </span><span class="n">which_data</span><span class="p">(</span><span class="n">scatt_type</span><span class="p">,</span> <span class="n">get_scatt</span><span class="p">,</span> <span class="n">get_nuscatt</span><span class="p">,</span> <span class="n">get_chi_t</span><span class="p">,</span> <span class="n">get_chi_p</span><span class="p">,</span> <span class="p">&amp;</span>
                <span class="n">get_chi_d</span><span class="p">,</span> <span class="n">scatt_order</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="whitespace-in-expressions">
<h3>2.1.6. Whitespace in Expressions<a class="headerlink" href="#whitespace-in-expressions" title="Permalink to this headline">¶</a></h3>
<p>Use a single space between arguments to procedures.</p>
<p>Avoid extraneous whitespace in the following situations:</p>
<ul>
<li><p class="first">In procedure calls:</p>
<div class="highlight-python"><div class="highlight"><pre>Yes: call somesub(x, y(2), z)
No:  call somesub( x, y( 2 ), z )
</pre></div>
</div>
</li>
<li><p class="first">In logical expressions, use one space around operators but nowhere else:</p>
<div class="highlight-python"><div class="highlight"><pre>Yes: if (variable == 2) then
No:  if ( variable==2 ) then
</pre></div>
</div>
</li>
</ul>
<p>Do not leave trailing whitespace at the end of a line.</p>
</div>
</div>
<div class="section" id="python">
<h2>2.2. Python<a class="headerlink" href="#python" title="Permalink to this headline">¶</a></h2>
<p>Style for Python code should follow <a class="reference external" href="https://www.python.org/dev/peps/pep-0008/">PEP8</a>.</p>
<p>Docstrings for functions and methods should follow <a class="reference external" href="https://github.com/numpy/numpy/blob/master/doc/HOWTO_DOCUMENT.rst.txt">numpydoc</a> style.</p>
<p>Python code should work with both Python 2.7+ and Python 3.0+.</p>
<p>Use of third-party Python packages should be limited to <a class="reference external" href="http://www.numpy.org/">numpy</a>, <a class="reference external" href="http://www.scipy.org/">scipy</a>, and
<a class="reference external" href="http://www.h5py.org/">h5py</a>. Use of other third-party packages must be implemented as optional
dependencies rather than required dependencies.</p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="structures.html">1. Data Structures</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="workflow.html">3. Development Workflow</a>&#160;&#160;»
        </p>

      </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2015, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.3.
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>
</html>