<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>1. Data Structures &mdash; OpenMC Documentation</title>
    
    <link rel="stylesheet" href="../_static/haiku.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.7.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="top" title="OpenMC Documentation" href="../index.html" />
    <link rel="up" title="Developer’s Guide" href="index.html" />
    <link rel="next" title="2. Style Guide for OpenMC" href="styleguide.html" />
    <link rel="prev" title="Developer’s Guide" href="index.html" /> 
  </head>
  <body role="document">
      <div class="header" role="banner">
        <a href="../index.html">
          <img class="logo" src="../_static/openmc.png" alt="Logo"/>
        </a>
      </div>
      <div class="topnav" role="navigation" aria-label="top navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Developer&#8217;s Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="styleguide.html">2. Style Guide for OpenMC</a>&#160;&#160;»
        </p>

      </div>
      <div class="content">
        
        
  <div class="section" id="data-structures">
<span id="devguide-structures"></span><h1>1. Data Structures<a class="headerlink" href="#data-structures" title="Permalink to this headline">¶</a></h1>
<p>The purpose of this section is to give you an overview of the major data
structures in OpenMC and how they are logically related. A majority of variables
in OpenMC are <a class="reference external" href="http://nf.nci.org.au/training/FortranAdvanced/slides/slides.025.html">derived types</a> (similar to a struct in C). These derived types
are defined in the various header modules, e.g. src/geometry_header.F90. Most
important variables are found in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a>. Have a look through that
module to get a feel for what variables you&#8217;ll often come across when looking at
OpenMC code.</p>
<div class="section" id="particle">
<h2>1.1. Particle<a class="headerlink" href="#particle" title="Permalink to this headline">¶</a></h2>
<p>Perhaps the variable that you will see most often is simply called <code class="docutils literal"><span class="pre">p</span></code> and is
of type(Particle). This variable stores information about a particle&#8217;s physical
characteristics (coordinates, direction, energy), what cell and material it&#8217;s
currently in, how many collisions it has undergone, etc. In practice, only one
particle is followed at a time so there is no array of type(Particle). The
Particle type is defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/particle_header.F90">particle_header module</a>.</p>
<p>You will notice that the direction and angle of the particle is stored in a
linked list of type(LocalCoord). In geometries with multiple <a class="reference internal" href="../methods/geometry.html#universes"><span>Universes</span></a>,
the coordinates in each universe are stored in this linked list. If universes or
lattices are not used in a geometry, only one LocalCoord is present in the
linked list.</p>
<p>The LocalCoord type has a component called cell which gives the index in the
<code class="docutils literal"><span class="pre">cells</span></code> array in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a>. The <code class="docutils literal"><span class="pre">cells</span></code> array is of type(Cell)
and stored information about each region defined by the user.</p>
</div>
<div class="section" id="cell">
<h2>1.2. Cell<a class="headerlink" href="#cell" title="Permalink to this headline">¶</a></h2>
<p>The Cell type is defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/geometry_header.F90">geometry_header module</a> along with other
geometry-related derived types. Each cell in the problem is described in terms
of its bounding surfaces, which are listed on the <code class="docutils literal"><span class="pre">surfaces</span></code> component. The
absolute value of each item in the <code class="docutils literal"><span class="pre">surfaces</span></code> component contains the index of
the corresponding surface in the <code class="docutils literal"><span class="pre">surfaces</span></code> array defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global
module</a>. The sign on each item in the <code class="docutils literal"><span class="pre">surfaces</span></code> component indicates whether
the cell exists on the positive or negative side of the surface (see
<a class="reference internal" href="../methods/geometry.html#methods-geometry"><span>Geometry</span></a>).</p>
<p>Each cell can either be filled with another universe/lattice or with a
material. If it is filled with a material, the <code class="docutils literal"><span class="pre">material</span></code> component gives the
index of the material in the <code class="docutils literal"><span class="pre">materials</span></code> array defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global
module</a>.</p>
</div>
<div class="section" id="surface">
<h2>1.3. Surface<a class="headerlink" href="#surface" title="Permalink to this headline">¶</a></h2>
<p>The Surface type is defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/geometry_header.F90">geometry_header module</a>. A surface is
defined by a type (sphere, cylinder, etc.) and a list of coefficients for that
surface type. The simplest example would be a plane perpendicular to the xy, yz,
or xz plane which needs only one parameter. The <code class="docutils literal"><span class="pre">type</span></code> component indicates the
type through integer parameters such as SURF_SPHERE or SURF_CYL_Y (these are
defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/constants.F90">constants module</a>). The <code class="docutils literal"><span class="pre">coeffs</span></code> component gives the
necessary coefficients to parameterize the surface type (see
<a class="reference internal" href="../usersguide/input.html#surface-element"><span>&lt;surface&gt; Element</span></a>).</p>
</div>
<div class="section" id="material">
<h2>1.4. Material<a class="headerlink" href="#material" title="Permalink to this headline">¶</a></h2>
<p>The Material type is defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/material_header.F90">material_header module</a>. Each material
contains a number of nuclides at a given atom density. Each item in the
<code class="docutils literal"><span class="pre">nuclide</span></code> component corresponds to the index in the global <code class="docutils literal"><span class="pre">nuclides</span></code> array
(as usual, found in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a>). The <code class="docutils literal"><span class="pre">atom_density</span></code> component is the
same length as the <code class="docutils literal"><span class="pre">nuclides</span></code> component and lists the corresponding atom
density in atom/barn-cm for each nuclide in the <code class="docutils literal"><span class="pre">nuclides</span></code> component.</p>
<p>If the material contains nuclides for which binding effects are important in
low-energy scattering, a <img class="math" src="../_images/math/ae80b12010e94b47829ea5bd0f66ab65510a9044.png" alt="S(\alpha,\beta)"/> can be associated with that
material through the <code class="docutils literal"><span class="pre">sab_table</span></code> component. Again, this component contains the
index in the <code class="docutils literal"><span class="pre">sab_tables</span></code> array from the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a>.</p>
</div>
<div class="section" id="nuclide">
<h2>1.5. Nuclide<a class="headerlink" href="#nuclide" title="Permalink to this headline">¶</a></h2>
<p>The Nuclide derived type stores cross section and interaction data for a nucleus
and is defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/ace_header.F90">ace_header module</a>. The <code class="docutils literal"><span class="pre">energy</span></code> component is an array
that gives the discrete energies at which microscopic cross sections are
tabulated. The actual microscopic cross sections are stored in a separate
derived type, Reaction. An arrays of Reactions is present in the <code class="docutils literal"><span class="pre">reactions</span></code>
component. There are a few summary microscopic cross sections stored in other
components, such as <code class="docutils literal"><span class="pre">total</span></code>, <code class="docutils literal"><span class="pre">elastic</span></code>, <code class="docutils literal"><span class="pre">fission</span></code>, and <code class="docutils literal"><span class="pre">nu_fission</span></code>.</p>
<p>If a Nuclide is fissionable, the prompt and delayed neutron yield and energy
distributions are also stored on the Nuclide type. Many nuclides also have
unresolved resonance probability table data. If present, this data is stored in
the component <code class="docutils literal"><span class="pre">urr_data</span></code> of derived type UrrData. A complete description of
the probability table method is given in <a class="reference internal" href="../methods/physics.html#probability-tables"><span>Unresolved Resonance Region Probability Tables</span></a>.</p>
<p>The list of nuclides present in a problem is stored in the <code class="docutils literal"><span class="pre">nuclides</span></code> array
defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a>.</p>
</div>
<div class="section" id="salphabeta">
<h2>1.6. SAlphaBeta<a class="headerlink" href="#salphabeta" title="Permalink to this headline">¶</a></h2>
<p>The SAlphaBeta derived type stores <img class="math" src="../_images/math/ae80b12010e94b47829ea5bd0f66ab65510a9044.png" alt="S(\alpha,\beta)"/> data to account for
molecular binding effects when treating thermal scattering. Each SAlphaBeta
table is associated with a specific nuclide as identified in the <code class="docutils literal"><span class="pre">zaid</span></code>
component. A complete description of the <img class="math" src="../_images/math/ae80b12010e94b47829ea5bd0f66ab65510a9044.png" alt="S(\alpha,\beta)"/> treatment can
be found in <a class="reference internal" href="../methods/physics.html#sab-tables"><span>S() Tables</span></a>.</p>
</div>
<div class="section" id="xslisting">
<h2>1.7. XsListing<a class="headerlink" href="#xslisting" title="Permalink to this headline">¶</a></h2>
<p>The XsListing derived type stores information on the location of an ACE cross
section table based on the data in cross_sections.xml and is defined in the
<a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/ace_header.F90">ace_header module</a>. For each <code class="docutils literal"><span class="pre">&lt;ace_table&gt;</span></code> you see in cross_sections.xml,
there is a XsListing with its information. When the user input is read, the
array <code class="docutils literal"><span class="pre">xs_listings</span></code> in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a> that is of derived type XsListing
is used to locate the ACE data to parse.</p>
</div>
<div class="section" id="nuclidemicroxs">
<h2>1.8. NuclideMicroXS<a class="headerlink" href="#nuclidemicroxs" title="Permalink to this headline">¶</a></h2>
<p>The NuclideMicroXS derived type, defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/ace_header.F90">ace_header module</a>, acts as a
&#8216;cache&#8217; for microscopic cross sections. As a particle is traveling through
different materials, cross sections can be reused if the energy of the particle
hasn&#8217;t changed. The components <code class="docutils literal"><span class="pre">total</span></code>, <code class="docutils literal"><span class="pre">elastic</span></code>, <code class="docutils literal"><span class="pre">absorption</span></code>,
<code class="docutils literal"><span class="pre">fission</span></code>, and <code class="docutils literal"><span class="pre">nu_fission</span></code> represent those microscopic cross sections at
the current energy of the particle for a given nuclide. An array <code class="docutils literal"><span class="pre">micro_xs</span></code> in
the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global module</a> that is the same length as the <code class="docutils literal"><span class="pre">nuclides</span></code> array stores
these cached cross sections for each nuclide in the problem.</p>
</div>
<div class="section" id="materialmacroxs">
<h2>1.9. MaterialMacroXS<a class="headerlink" href="#materialmacroxs" title="Permalink to this headline">¶</a></h2>
<p>In addition to the NuclideMicroXS type, there is also a MaterialMacroXS derived
type, defined in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/ace_header.F90">ace_header module</a> that stored cached <em>macroscopic</em> cross
sections for the current material. These macroscopic cross sections are used for
both physics and tallying purposes. The variable <code class="docutils literal"><span class="pre">material_xs</span></code> in the <a class="reference external" href="https://github.com/mit-crpg/openmc/blob/master/src/global.F90">global
module</a> is of type MaterialMacroXS.</p>
</div>
</div>


      </div>
      <div class="bottomnav" role="navigation" aria-label="bottom navigation">
      
        <p>
        «&#160;&#160;<a href="index.html">Developer&#8217;s Guide</a>
        &#160;&#160;::&#160;&#160;
        <a class="uplink" href="../index.html">Contents</a>
        &#160;&#160;::&#160;&#160;
        <a href="styleguide.html">2. Style Guide for OpenMC</a>&#160;&#160;»
        </p>

      </div>


    <div class="footer" role="contentinfo">
        &copy; Copyright 2011-2015, Massachusetts Institute of Technology.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.3.1.
    </div>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-30411614-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  </body>
</html>